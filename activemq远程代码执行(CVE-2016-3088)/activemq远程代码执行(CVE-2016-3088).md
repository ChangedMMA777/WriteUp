# activemq远程代码执行(CVE-2016-3088)
## 漏洞描述
ActiveMQ 是 Apache 软件基金会下的一个开源消息驱动中间件软件。 ActiveMQ中的fileserver服务允许用户通过HTTP PUT方法上传文件到指定目录。Fileserver支持写入文件(不解析jsp),但是支持移动文件(Move)我们可以将jsp的文件PUT到Fileserver下,然后再通过Move指令移动到可执行目录下访问。 用户名密码：admin:admin 路径：file////opt/apache-activemq-5.11.1/webapps

## 影响版本
Apache ActiveMQ 5.x ~ 5.14.0

## 利用流程
1.访问地址：118.193.36.37:21608

![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(CVE-2016-3088)/1.jpg)
2.查看绝对路径 并登录(弱口令) 
```
admin/test/systemProperties.jsp	admin/admin

```
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(CVE-2016-3088)/2.jpg)
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(CVE-2016-3088)/3.jpg)
3.burpsuite进行抓包 PUT上传文件：
```
/fileserver/shell.txt
```
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(CVE-2016-3088)/4.jpg)
访问上传的文件的网页：

![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(CVE-2016-3088)/5.jpg)
4.将shell.txt移动到其他可执行jsp文件目录：
```
Destination: file:///opt/apache-activemq-5.11.1/webapps/admin/shell.jsp
```
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/activemq%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C(CVE-2016-3088)/6.jpg)
5.访问此网页执行命令
getflag
