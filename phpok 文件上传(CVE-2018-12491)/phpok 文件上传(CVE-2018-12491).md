# phpok 文件上传(CVE-2018-12491)
## 漏洞描述
PHPOK是一套采用PHP+MYSQL语言开发的企业网站系统。 PHPOK存在后台文件上传漏洞，攻击者可利用该漏洞获取网站服务器控制权。

## 影响版本
5.0.0 <= vBulletin <=5.5.4
## 利用流程
1.访问地址：http://118.193.36.37:61104     并登录admin/123456

![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/phpok%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(CVE-2018-12491)/1.jpg)
2.进入 工具 -> 附件分类管理 将附件类型进行修改将php添加 选择将本地的一句话木马上传

![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/phpok%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(CVE-2018-12491)/2.jpg)

![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/phpok%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(CVE-2018-12491)/3.jpg)

![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/phpok%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(CVE-2018-12491)/4.jpg)
![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/phpok%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(CVE-2018-12491)/5.jpg)

![image](https://github.com/LiuYuH-hash/WriteUp/blob/main/phpok%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(CVE-2018-12491)/6.jpg)


4.预览附件信息 找到shell路径和文件名称

![image]([image](https://github.com/LiuYuH-hash/WriteUp/blob/main/phpok%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(CVE-2018-12491)/7.jpg)

5.访问shell

![image]([image](https://github.com/LiuYuH-hash/WriteUp/blob/main/phpok%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(CVE-2018-12491)/8.jpg)

6.蚁剑连接一句话木马 在虚拟终端中ls /tmp查找flag

![image]([image](https://github.com/LiuYuH-hash/WriteUp/blob/main/phpok%20%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0(CVE-2018-12491)/9.jpg)

